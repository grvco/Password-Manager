(function framework7ComponentLoader(t,e){void 0===e&&(e=!0);var a=t.$,o=t.utils,r=(t.getDevice,t.getSupport,t.Class,t.Modal,t.ConstructorMethods,t.ModalMethods,o.serializeObject),n=o.extend;const s={store(t,e){const o=o;let r=t;const n=a(t);n.length&&n.is("form")&&n.attr("id")&&(r=n.attr("id")),this.form.data[`form-${r}`]=e,o.localStorage[`f7form-${r}`]=JSON.stringify(e)},get(t){const e=this,o=o;let r=t;const n=a(t);return n.length&&n.is("form")&&n.attr("id")&&(r=n.attr("id")),o.localStorage[`f7form-${r}`]?JSON.parse(o.localStorage[`f7form-${r}`]):e.form.data[`form-${r}`]?e.form.data[`form-${r}`]:void 0},remove(t){const e=this,o=o;let r=t;const n=a(t);n.length&&n.is("form")&&n.attr("id")&&(r=n.attr("id")),e.form.data[`form-${r}`]&&(e.form.data[`form-${r}`]="",delete e.form.data[`form-${r}`]),o.localStorage[`f7form-${r}`]&&(o.localStorage[`f7form-${r}`]="",o.localStorage.removeItem(`f7form-${r}`))}},i={init(t){const e=this,o=a(t),r=o.attr("id");if(!r)return;const n=e.form.getFormData(r);n&&e.form.fillFromData(o,n),o.on("change submit",(function(){const t=e.form.convertToData(o);t&&(e.form.storeFormData(r,t),o.trigger("form:storedata",t),e.emit("formStoreData",o[0],t))}))},destroy(t){a(t).off("change submit")}};function f(t){const e=a(t).eq(0);if(0===e.length)return;const o={},r=["submit","image","button","file"],n=[];return e.find("input, select, textarea").each((t=>{const s=a(t);if(s.hasClass("ignore-store-data")||s.hasClass("no-store-data"))return;const i=s.attr("name"),f=s.attr("type"),c=t.nodeName.toLowerCase();if(!(r.indexOf(f)>=0)&&!(n.indexOf(i)>=0)&&i)if("select"===c&&s.prop("multiple"))n.push(i),o[i]=[],e.find(`select[name="${i}"] option`).each((t=>{t.selected&&o[i].push(t.value)}));else switch(f){case"checkbox":n.push(i),o[i]=[],e.find(`input[name="${i}"]`).each((t=>{t.checked&&o[i].push(t.value)}));break;case"radio":n.push(i),e.find(`input[name="${i}"]`).each((t=>{t.checked&&(o[i]=t.value)}));break;default:o[i]=s.val()}})),e.trigger("form:todata",o),this.emit("formToData",e[0],o),o}function c(t,e){const o=this,r=a(t).eq(0);if(!r.length)return;let n=e;const s=r.attr("id");if(!n&&s&&(n=o.form.getFormData(s)),!n)return;const i=["submit","image","button","file"],f=[];r.find("input, select, textarea").each((t=>{const e=a(t);if(e.hasClass("ignore-store-data")||e.hasClass("no-store-data"))return;const o=e.attr("name"),s=e.attr("type"),c=t.nodeName.toLowerCase();if(void 0!==n[o]&&null!==n[o]&&!(i.indexOf(s)>=0)&&!(f.indexOf(o)>=0)&&o){if("select"===c&&e.prop("multiple"))f.push(o),r.find(`select[name="${o}"] option`).each((t=>{const e=t;n[o].indexOf(t.value)>=0?e.selected=!0:e.selected=!1}));else switch(s){case"checkbox":f.push(o),r.find(`input[name="${o}"]`).each((t=>{const e=t;n[o].indexOf(t.value)>=0?e.checked=!0:e.checked=!1}));break;case"radio":f.push(o),r.find(`input[name="${o}"]`).each((t=>{const e=t;n[o]===t.value?e.checked=!0:e.checked=!1}));break;default:e.val(n[o])}"select"!==c&&"input"!==c&&"textarea"!==c||e.trigger("change","fromdata")}})),r.trigger("form:fromdata",n),o.emit("formFromData",r[0],n)}function m(){const t=this,e=e,o=o;a(o).on("submit change","form.form-ajax-submit, form.form-ajax-submit-onchange",(function(o,n){const s=a(this);if("change"===o.type&&!s.hasClass("form-ajax-submit-onchange"))return;if("submit"===o.type&&o.preventDefault(),"change"===o.type&&"fromdata"===n)return;const i=(s.attr("method")||"GET").toUpperCase(),f=s.prop("enctype")||s.attr("enctype"),c=s.attr("action");if(!c)return;let m;m="POST"===i?"application/x-www-form-urlencoded"===f?t.form.convertToData(s[0]):new e.FormData(s[0]):r(t.form.convertToData(s[0])),t.request({method:i,url:c,contentType:f,data:m,beforeSend(e){s.trigger("formajax:beforesend",{data:m,xhr:e}),t.emit("formAjaxBeforeSend",s[0],m,e)},error(e){s.trigger("formajax:error",{data:m,xhr:e}),t.emit("formAjaxError",s[0],m,e)},complete(e){s.trigger("formajax:complete",{data:m,xhr:e}),t.emit("formAjaxComplete",s[0],m,e)},success(e,a,o){s.trigger("formajax:success",{data:m,xhr:o}),t.emit("formAjaxSuccess",s[0],m,o)}})}))}var d={name:"form",create(){const t=this;n(t,{form:{data:{},storeFormData:s.store.bind(t),getFormData:s.get.bind(t),removeFormData:s.remove.bind(t),convertToData:f.bind(t),fillFromData:c.bind(t),storage:{init:i.init.bind(t),destroy:i.destroy.bind(t)}}})},on:{init(){m.call(this)},tabBeforeRemove(t){const e=this;a(t).find(".form-store-data").each((t=>{e.form.storage.destroy(t)}))},tabMounted(t){const e=this;a(t).find(".form-store-data").each((t=>{e.form.storage.init(t)}))},pageBeforeRemove(t){const e=this;t.$el.find(".form-store-data").each((t=>{e.form.storage.destroy(t)}))},pageInit(t){const e=this;t.$el.find(".form-store-data").each((t=>{e.form.storage.init(t)}))}}};if(e){if(t.prototype.modules&&t.prototype.modules[d.name])return;t.use(d),t.instance&&(t.instance.useModuleParams(d,t.instance.params),t.instance.useModule(d))}return d}(Framework7, typeof Framework7AutoInstallComponent === 'undefined' ? undefined : Framework7AutoInstallComponent))
